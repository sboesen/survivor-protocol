<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Survivor Protocol v2.3</title>
</head>
<body>

<div id="game-container">
    <canvas id="gameCanvas"></canvas>

    <div id="damage-layer"></div>

    <div id="ui-layer">
        <div class="xp-bar-container"><div id="xp-bar-fill"></div></div>
        <div class="hud-top">
            <div>
                <div><span id="hud-char">Knight</span> LVL <span id="hud-level">1</span></div>
                <div style="margin-top:5px"><span id="hud-timer">00:00</span> <span style="color:#666">|</span> Kills: <span id="hud-kills">0</span></div>
            </div>
            <div style="display:flex; align-items:center;">
                <span id="hud-gold" style="color:var(--gold)">üí∞ 0</span>
                <button class="quit-btn" onclick="Game.quitRun()">ABORT</button>
            </div>
        </div>

        <!-- Mobile Ultimate Button -->
        <div id="ult-btn" class="ult-btn" onclick="Game.triggerUlt()">
            ‚ö°
            <span class="btn-hotkey">Z</span>
            <div id="ult-cooldown-overlay" class="ult-cooldown" style="height:100%"></div>
        </div>

        <!-- Mobile Weapon Fire Button (for manual weapons like Flicker Strike) -->
        <div id="weapon-fire-btn" class="weapon-fire-btn">
            ‚öîÔ∏è
            <span class="btn-hotkey">SPACE</span>
        </div>
    </div>

    <!-- Main Menu -->
    <div id="menu-screen" class="screen active">
        <h1>SURVIVOR<br>PROTOCOL</h1>
        <h2 style="color:#aaa">v2.3: Bosses & Bounties</h2>
        <div class="char-scroll" id="char-select-list"></div>
        <div style="margin-top:20px;">
            <button onclick="Game.start()" style="font-size:12px; padding:15px 30px;">START MISSION</button>
        </div>
        <div style="margin-top:10px;">
            <button onclick="Menu.openGacha()">SUMMON HERO (500G)</button>
            <button onclick="Menu.openShop()">PASSIVE UPGRADES</button>
        </div>
        <button class="debug-btn-toggle" onclick="Menu.openDebug()">[ DEBUG MENU ]</button>
    </div>

    <!-- Debug Screen -->
    <div id="debug-screen" class="screen">
        <h1 style="color:var(--debug)">DEBUG TERMINAL</h1>
        <div class="debug-menu-content">
            <button class="debug-action-btn" onclick="Debug.addGold(5000)">ADD 5000 GOLD</button>
            <button class="debug-action-btn" onclick="Debug.unlockAll()">UNLOCK ALL PILOTS</button>
            <button class="debug-action-btn" onclick="Debug.resetProgress()" style="border-color: #f00;">WIPE ALL DATA</button>
        </div>

        <div style="margin-top:20px;">
            <h3 style="color:#aaa;">PARTICLE TEST</h3>
            <canvas id="particle-debug-canvas" width="300" height="200" style="background:#111; border:1px solid #444; margin:10px 0;"></canvas>
            <div style="display:flex; gap:5px; flex-wrap:wrap; justify-content:center;">
                <button onclick="ParticleDebug.spawn('water')" style="font-size:10px;">WATER</button>
                <button onclick="ParticleDebug.spawn('splash')" style="font-size:10px;">SPLASH</button>
                <button onclick="ParticleDebug.spawn('ripple')" style="font-size:10px;">RIPPLE</button>
                <button onclick="ParticleDebug.spawn('caustic')" style="font-size:10px;">CAUSTIC</button>
                <button onclick="ParticleDebug.spawn('foam')" style="font-size:10px;">FOAM</button>
                <button onclick="ParticleDebug.spawn('explosion')" style="font-size:10px;">BOOM</button>
                <button onclick="ParticleDebug.spawn('blood')" style="font-size:10px;">BLOOD</button>
                <button onclick="ParticleDebug.spawn('smoke')" style="font-size:10px;">SMOKE</button>
                <button onclick="ParticleDebug.clear()" style="font-size:10px; border-color:#f00;">CLEAR</button>
            </div>
            <p style="font-size:9px; color:#666; margin-top:10px;">Particles don't disappear - use to test visuals</p>
        </div>

        <button onclick="Menu.closeDebug()" style="margin-top:20px;">EXIT DEBUG</button>
    </div>

    <!-- Gacha Screen -->
    <div id="gacha-screen" class="screen">
        <h1 style="color:var(--rare)">NEURAL UPLINK</h1>
        <canvas id="gacha-canvas" width="200" height="200"></canvas>
        <div id="gacha-result">System Ready...</div>
        <div class="gacha-controls">
            <button id="pull-btn" onclick="GachaAnim.startPull()">SUMMON (500G)</button>
            <button id="gacha-back-btn" onclick="Menu.closeGacha()">RETURN</button>
        </div>
        <p style="margin-top:20px; font-size:10px; color:var(--gold)">Gold: <span id="gacha-gold">0</span></p>
    </div>

    <!-- Shop Screen -->
    <div id="shop-screen" class="screen">
        <h1>ARMORY</h1>
        <h2>Gold: <span id="shop-gold-display">0</span></h2>
        <div id="shop-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; max-height:60vh; overflow-y:auto;"></div>
        <button onclick="Menu.closeShop()" style="margin-top:20px;">BACK</button>
    </div>

    <!-- Level Up Screen -->
    <div id="levelup-screen" class="screen">
        <h1>LEVEL UP!</h1>
        <p style="font-size:10px; color:#aaa; margin-bottom:20px;">Choose an upgrade</p>
        <div id="card-container"></div>
    </div>

    <!-- Game Over Screen -->
    <div id="gameover-screen" class="screen">
        <h1 id="go-title" style="color: #ff3333;">KIA</h1>
        <div id="go-stats" style="margin-bottom: 20px; text-align: left; background: #222; padding: 20px; border: 1px solid #444;">
            <!-- Populated by JS -->
        </div>
        <button onclick="Game.returnToMenu()">EXTRACT</button>
    </div>
</div>

<script type="module" src="/src/main.ts"></script>
</body>
</html>
